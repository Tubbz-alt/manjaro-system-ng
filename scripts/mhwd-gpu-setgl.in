#!/bin/sh

source @prefix@/share/libalpm/util-manjaro.sh

if [ "$(mhwd -li | grep catalyst)" != "" ] && \
[ "$(mhwd -li | grep hybrid)" == "" ]; then
        msg "Fixing catalyst settings ..."
        mhwd-gpu --setgl catalyst
fi
if [ "$(mhwd -li | grep hybrid)" != "" ]; then
        msg "Fixing hybrid settings ..."
        mhwd-gpu --setgl mesa
fi
if [ "$(mhwd -li | grep nvidia)" != "" ] && \
[ "$(mhwd -li | grep hybrid)" == "" ] ; then
        msg "Fixing nvidia settings ..."
        mhwd-gpu --setgl nvidia
fi

mhwd-gpu --check

msg "use mhwd-gpu to set catalyst as default: 'mhwd-gpu --setgl catalyst'"
msg "use mhwd-gpu to set mesa as default: 'mhwd-gpu --setgl mesa'"
msg "use mhwd-gpu to set nvidia as default: 'mhwd-gpu --setgl nvidia'"
